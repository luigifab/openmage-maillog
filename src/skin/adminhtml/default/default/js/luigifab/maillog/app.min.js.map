{"version":3,"sources":["app.js"],"sourcesContent":["/**\n * Created J/03/12/2015\n * Updated D/17/01/2021\n *\n * Copyright 2015-2021 | Fabrice Creuzot (luigifab) <code~luigifab~fr>\n * Copyright 2015-2016 | Fabrice Creuzot <fabrice.creuzot~label-park~com>\n * Copyright 2017-2018 | Fabrice Creuzot <fabrice~reactive-web~fr>\n * Copyright 2020-2021 | Fabrice Creuzot <fabrice~cellublue~com>\n * https://www.luigifab.fr/openmage/maillog\n *\n * This program is free software, you can redistribute it or modify\n * it under the terms of the GNU General Public License (GPL) as published\n * by the free software foundation, either version 2 of the license, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but without any warranty, without even the implied warranty of\n * merchantability or fitness for a particular purpose. See the\n * GNU General Public License (GPL) for more details.\n */\n\nif (window.NodeList && !NodeList.prototype.forEach) {\n\tNodeList.prototype.forEach = function (callback, that, i) {\n\t\tthat = that || window;\n\t\tfor (i = 0; i < this.length; i++)\n\t\t\tcallback.call(that, this[i], i, this);\n\t};\n}\n\nvar maillog = new (function () {\n\n\t\"use strict\";\n\tthis.types    = ['dolist', 'emarsys'];\n\tthis.template = null;\n\tthis.nextIdx  = 0;\n\n\tthis.start = function () {\n\n\t\tvar elem, customer, bounce, subscriber, i, j;\n\n\t\tif (document.getElementById('maillog_sync_bounces_stats_customer')) {\n\n\t\t\tconsole.info('maillog.app - hello');\n\t\t\tcustomer   = document.getElementById('maillog_sync_bounces_stats_customer');\n\t\t\tbounce     = document.getElementById('maillog_sync_bounces_stats_bounce');\n\t\t\tsubscriber = document.getElementById('maillog_sync_unsubscribers_stats_subscriber');\n\n\t\t\ti = parseInt(customer.textContent.trim(), 10);\n\t\t\tj = parseInt(bounce.textContent.trim(), 10);\n\t\t\tbounce.textContent += ' (' + Math.floor(j * 100 / i) + ' %)';\n\n\t\t\ti = parseInt(customer.textContent.trim(), 10);\n\t\t\tj = parseInt(subscriber.textContent.trim(), 10);\n\t\t\tsubscriber.textContent += ' (' + Math.floor(j * 100 / i) + ' %)';\n\t\t}\n\t\telse if (elem = document.getElementById('row_maillog_directives_general_special_config')) {\n\n\t\t\tconsole.info('maillog.app - hello');\n\n\t\t\telem = elem.querySelector('tr.template');\n\t\t\tthis.template = elem.innerHTML;\n\t\t\tthis.nextIdx  = parseInt(elem.getAttribute('data-next'), 10);\n\t\t\telem.parentNode.removeChild(elem);\n\t\t}\n\t};\n\n\tthis.add = function (code) {\n\n\t\tvar sys = document.getElementById('maillog_sync_' + code + '_mapping_system'),\n\t\t    mag = document.getElementById('maillog_sync_' + code + '_mapping_openmage'),\n\t\t    cnf = document.getElementById('maillog_sync_' + code + '_mapping_config');\n\n\t\tif ((sys.value.length > 0) && (mag.value.length > 0)) {\n\t\t\tcnf.value = (cnf.value + '\\n' + sys.value + ':' + mag.value).trim();\n\t\t\tcnf.scrollTop = cnf.scrollHeight;\n\t\t\tsys.selectedIndex = 0;\n\t\t\tmag.selectedIndex = 0;\n\t\t\tthis.mark();\n\t\t}\n\t};\n\n\tthis.mark = function (fields) {\n\n\t\tthis.types.forEach(function (code) {\n\n\t\t\tfields = document.getElementById('maillog_sync_' + code + '_mapping_config').value;\n\n\t\t\tdocument.getElementById('maillog_sync_' + code + '_mapping_system').querySelectorAll('option').forEach(function (elem) {\n\t\t\t\tif ((fields.indexOf('\\n' + elem.value + ':') > -1) || (fields.indexOf(elem.value + ':') === 0))\n\t\t\t\t\telem.setAttribute('class', 'has');\n\t\t\t\telse\n\t\t\t\t\telem.removeAttribute('class');\n\t\t\t});\n\n\t\t\tdocument.getElementById('maillog_sync_' + code + '_mapping_openmage').querySelectorAll('option').forEach(function (elem) {\n\t\t\t\tif (fields.indexOf(':' + elem.value) > -1)\n\t\t\t\t\telem.setAttribute('class', 'has');\n\t\t\t\telse\n\t\t\t\t\telem.removeAttribute('class');\n\t\t\t});\n\t\t});\n\t};\n\n\tthis.iframe = function (elem) {\n\n\t\ttry {\n\t\t\telem.removeAttribute('onload');\n\t\t\telem.contentDocument.querySelector('body').parentNode.innerHTML = decodeURIComponent(escape(self.atob(elem.firstChild.nodeValue)));\n\t\t\telem.style.height = elem.contentDocument.querySelector('body').scrollHeight + 'px';\n\t\t\tself.setTimeout(function () {\n\t\t\t\tvar elem = document.querySelector('div.content iframe');\n\t\t\t\telem.style.height = elem.contentDocument.querySelector('body').scrollHeight + 'px';\n\t\t\t}, 1000);\n\t\t}\n\t\tcatch (e) {\n\t\t\telem.contentDocument.querySelector('body').textContent = e;\n\t\t}\n\t};\n\n\tthis.resetLifetime = function (elem, color) {\n\n\t\telem = elem.parentNode;\n\t\telem.querySelectorAll('select')[0].selectedIndex = 0;\n\t\telem.querySelectorAll('select')[1].selectedIndex = 0;\n\t\telem.querySelectorAll('input')[0].value = color.toLowerCase();\n\t\telem.querySelectorAll('input')[1].value = '#000000';\n\t};\n\n\tthis.removeLifetime = function (elem) {\n\n\t\tif (confirm(Translator.translate('Are you sure?')))\n\t\t\telem.parentNode.parentNode.removeChild(elem.parentNode);\n\t};\n\n\tthis.addPicture = function (elem) {\n\n\t\tvar tpl = document.createElement('tr'), root = elem.parentNode;\n\t\twhile (root.nodeName !== 'TABLE')\n\t\t\troot = root.parentNode;\n\n\t\troot = root.querySelector('tbody');\n\n\t\ttpl.setAttribute('class', 'added');\n\t\ttpl.innerHTML = this.template.\n\t\t\treplace(/IIDDXX/g, this.nextIdx).\n\t\t\treplace(/KKEEYY/g, '1');\n\n\t\troot.appendChild(tpl);\n\t\tthis.nextIdx += 1;\n\t};\n\n\tthis.deletePicture = function (elem) {\n\n\t\tif (confirm(Translator.translate('Are you sure?')))\n\t\t\telem.parentNode.parentNode.parentNode.removeChild(elem.parentNode.parentNode);\n\t};\n\n\tthis.addBreak = function (elem, idx) {\n\n\t\tvar tpl = document.createElement('ul'), ul = elem.parentNode.parentNode.parentNode.querySelector('ul');\n\n\t\ttpl.innerHTML = this.template.\n\t\t\treplace(/IIDDXX/g, idx).\n\t\t\treplace(/KKEEYY/g, ul.querySelectorAll('li').length);\n\n\t\tul.appendChild(tpl.querySelector('li.breakpoint'));\n\t};\n\n\tthis.deleteBreak = function (elem) {\n\n\t\tif (confirm(Translator.translate('Are you sure?')))\n\t\t\telem.parentNode.parentNode.parentNode.removeChild(elem.parentNode.parentNode);\n\t};\n\n})();\n\nif (typeof self.addEventListener == 'function')\n\tself.addEventListener('load', maillog.start.bind(maillog));"],"names":["window","NodeList","prototype","forEach","callback","that","i","this","length","call","maillog","types","template","nextIdx","start","customer","bounce","subscriber","j","document","getElementById","console","info","parseInt","textContent","trim","Math","floor","elem","querySelector","innerHTML","getAttribute","parentNode","removeChild","add","code","sys","mag","cnf","value","scrollTop","scrollHeight","selectedIndex","mark","fields","querySelectorAll","indexOf","setAttribute","removeAttribute","iframe","contentDocument","decodeURIComponent","escape","self","atob","firstChild","nodeValue","style","height","setTimeout","e","resetLifetime","color","toLowerCase","removeLifetime","confirm","Translator","translate","addPicture","tpl","createElement","root","nodeName","replace","appendChild","deletePicture","addBreak","idx","ul","deleteBreak","addEventListener","bind"],"mappings":"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"}